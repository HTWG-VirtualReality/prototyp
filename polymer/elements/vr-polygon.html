<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="vr-point.html">

<dom-module id="vr-polygon">
    <template>
        <content id="point" select="vr-point"></content>
    </template>
</dom-module>

<script>
    Polymer({
        is: "vr-polygon",

        ready: function() {
            var mod = this;
            mod.obj = new THREE.Group();

            function addMesh(shape, depth, color) {
                var extrudeSettings = {amount: depth, bevelEnabled: false};
                var geometry = new THREE.ExtrudeGeometry(shape, extrudeSettings);
                var mesh = new THREE.Mesh(geometry, new THREE.MeshBasicMaterial({color: color}));
                var wireframe = new THREE.Mesh(geometry, new THREE.MeshBasicMaterial({color: 0x000000, wireframe: true}));
                mod.obj.add(mesh);
                mod.obj.add(wireframe);
            }

            Polymer.dom(mod.$.point).observeNodes(function(points) {
                var shape = new THREE.Shape();
                shape.moveTo(0, 0);

                points.addedNodes.forEach(function(point) {
                    shape.lineTo(point.x, point.y);
                }.bind(mod));

                addMesh(shape, 2, 0xFFFFFF);
            }.bind(mod));
        }
    });
</script>
