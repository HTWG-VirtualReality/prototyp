<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="vr-point.html">

<dom-module id="vr-polygon">
    <template>
        <content id="point" select="vr-point"></content>
    </template>
</dom-module>

<script>
    Polymer({
        is: "vr-polygon",

        ready: function() {
            this.obj = new THREE.Group();

            function createMesh(shape, depth, color) {
                var extrudeSettings = {amount: depth, bevelEnabled: false};
                var geometry = new THREE.ExtrudeGeometry(shape, extrudeSettings);
                var mesh = new THREE.Mesh(geometry, new THREE.MeshPhongMaterial({color: color}));
                return mesh;
            }

            Polymer.dom(this.$.point).observeNodes(function(points) {
                var shape = new THREE.Shape();
                shape.moveTo(0, 0);

                points.addedNodes.forEach(function(point) {
                    shape.lineTo(point.x, point.y);
                }.bind(this));

                this.obj.add(createMesh(shape, 20, 0x4E33D4));
            }.bind(this));
        }
    });
</script>
