<link rel="import" href="../bower_components/polymer/polymer.html">
<script src="../bower_components/threex.dynamictexture/threex.dynamictexture.js"></script>

<script>
    Polymer({
        is: "vr-box",

        properties: {
            xPos: {
                type: Number,
                value: 0
            },
            yPos: {
                type: Number,
                value: 0
            },
            width: {
                type: Number,
                value: 50
            },
            height: {
                type: Number,
                value: 50
            },
            depth: {
                type: Number,
                value: 50
            },
            text: {
                type: String,
                value: ''
            }
        },

        observers: [
            'updateBox(xPos, yPos, width, height, depth, text)'
        ],

        updateBox: function(xPos, yPos, width, height, depth, text) {
            // TODO: box updaten oder neu erstellen....
            // 0=left
            // 1=right
            // 2=bottom
            // 3=top
            // 4=front
            // 5=back
            var sides = 6;
            var materials = [];
            // init all sides of cube
            for (var i = 0; i < sides; i++) {
                materials.push(new THREE.MeshBasicMaterial({
                    color: 0xffffff
                }));
            }

            var dynamicTexture = new THREEx.DynamicTexture(512, 512);
            dynamicTexture.context.font = "bolder 64px Verdana";
            dynamicTexture.clear('white').drawText(text, 20, 100, 'black');
            materials[4].map = dynamicTexture.texture;

            // Parameter 1: Width
            // Parameter 2: Height
            // Parameter 3: Depth
            var geometry = new THREE.BoxGeometry(width, height, depth),
                    cube = new THREE.Mesh(geometry, new THREE.MeshFaceMaterial(materials));

            this.wireframe = new THREE.BoxHelper(cube);
            this.wireframe.material.color.set(0x000000);

            this.obj = new THREE.Group();
            this.obj.position.setX(xPos);
            this.obj.position.setY(yPos);

            this.obj.add(cube);
            this.obj.add(this.wireframe);
        },

        ready: function() {
            this.updateBox(this.xPos, this.yPos, this.width, this.height, this.depth, this.text)
        },

        onClick: function() {
            if (this.wireframe.material.color.r == 0) {
                this.wireframe.material.color.set(0xff0000);
            } else {
                this.wireframe.material.color.set(0x000000);
            }
        }

    });
</script>