<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="vr-point.html">

<dom-module id="vr-polyline">
    <template>
        <content id="point" select="vr-point"></content>
    </template>
</dom-module>

<script>
    Polymer({
        is: "vr-polyline",

        properties: {
			dashed: {
				type: Boolean,
				value: false
			}
        },

        ready: function() {
			var mod = this;
			mod.obj = new THREE.Group();

			function addLine(geometry) {
				if(!mod.dashed) {
					var material = new THREE.LineBasicMaterial( { color : 0x000000, linewidth: 2 } );
				} else {
					var material = new THREE.LineDashedMaterial( {color: 0x000000, dashSize: 3, gapSize: 1, linewidth: 2});
					geometry.computeLineDistances();
				}

				mod.obj.add(new THREE.Line(geometry, material));
			}


			Polymer.dom(mod.$.point).observeNodes(function(points) {
				var geometry = new THREE.Geometry();

                points.addedNodes.forEach(function(point) {
                    geometry.vertices.push(new THREE.Vector3(point.x, point.y, 10));
                }.bind(mod));

                addLine(geometry);
            }.bind(mod));
        }

    });
</script>
