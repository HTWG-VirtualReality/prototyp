<script>
    window.VrBehaviors = window.VrBehaviors || {};
    VrBehaviors.ResizeBehavior = {

        properties: {
            width: {
                type: Number,
                value: 50
            },
            height: {
                type: Number,
                value: 50
            }
        },

        attached: function() {
            var depth = 12;
            var width = 3;
            var geometry = new THREE.CylinderGeometry(width, width, depth, 32);
            var padding = width/1.5;
            var group = this._createGroup();
            this._createMesh(group, geometry, padding, padding);
            this._createMesh(group, geometry, padding, this.height - padding);
            this._createMesh(group, geometry, this.width - padding, this.height - padding);
            this._createMesh(group, geometry, this.width - padding, padding);

        },

        onMouseOverGroup: function(event) {
            this._updateChildrenOpacity(event);
        },

        onMouseOutGroup: function(event) {
            this._updateChildrenOpacity(event);
        },

        onMouseDownGroup: function(event) {
            event.origDomEvent.stopImmediatePropagation();
            event.stopPropagation();
        },

        onMouseOverChild: function(event) {
            event.target.material.color.set(0xFF0000);
        },

        onMouseOutChild: function(event) {
            event.target.material.color.set(0x000000);
        },

        _createGroup: function() {
            var group = new THREE.Group();
            this.obj.add(group);
            group.on('mouseover', this.onMouseOverGroup.bind(this));
            group.on('mouseout', this.onMouseOutGroup.bind(this));
            group.on('mousedown', this.onMouseDownGroup.bind(this));
            return group;
        },

        _updateChildrenOpacity: function (event) {
            event.target.children.forEach(function (element) {
                element.material.opacity = (element.material.opacity === 1) ? 0 : 1;
            })
        },

        _createMesh: function(group, geometry, x, y) {
            var material = new THREE.MeshBasicMaterial({color: 0x000000, transparent: true, opacity: 0});
            var mesh = new THREE.Mesh(geometry, material);
            mesh.rotateX(90 * (Math.PI/180));
            mesh.position.x = x - (this.width/2);
            mesh.position.y = y - this.height;
            mesh.position.z += 1;
            group.add(mesh);

            mesh.on('mouseover', this.onMouseOverChild.bind(this));
            mesh.on('mouseout', this.onMouseOutChild.bind(this));
        }
    };
</script>